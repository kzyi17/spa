(function(b){var d=0;var a=b("#calendar");var c=function(e){this.options=e;if(this.options){this.oDate=new Date(this.options[0].time);this.oYear=this.oDate.getFullYear();this.oMonth=this.oDate.getMonth()+1;this.oDay=this.oDate.getDate();this.oWeek=this.oDate.getDay()}else{this.oDate=new Date();this.oYear=this.oDate.getFullYear();this.oMonth=this.oDate.getMonth()+1;this.oDay=this.oDate.getDate();this.oWeek=this.oDate.getDay()}this.init()};c.prototype={init:function(){this.render();this.showDate(this.oYear,this.oMonth)},render:function(){var m='<div class="hd"><div class="tc"><span id="start"></span>—<span id="end"></span></div> </div>';var e='<table cellpadding="0" cellspacing="0"><thead><th>日</th><th>一</th><th>二</th><th>三</th><th>四</th><th>五</th><th>六</th></thead><tbody></tbody></table>';a.append(m);a.append(e);b("#start").text(this.oMonth+"月"+this.oDay+"日");b("#end").text(((this.oMonth+1)>12?1:(this.oMonth+1))+"月"+this.oDay+"日");var l=a.find("tbody");for(var g=0;g<6;g++){var h=document.createElement("tr");for(var f=0;f<7;f++){var k=document.createElement("td");b(h).append(k)}b(l).append(h)}a.find("table").append(l)},_getDate:function(e){var f=0;if(e==1||e==3||e==5||e==7||e==8||e==10||e==12){f=31}else{if(e==4||e==6||e==9||e==11){f=30}else{if(e==2&&this.isLeapYear(this.oYear)){f=29}else{f=28}}}return f},showDate:function(e,f){var g=a.find("td");b(g).text("");b(g).removeClass("current");this.oDate.setFullYear(e);this.oDate.setMonth(f-1);switch(this.oDate.getDay()){case 0:this.selectDays(0,g);break;case 1:this.selectDays(1,g);break;case 2:this.selectDays(2,g);break;case 3:this.selectDays(3,g);break;case 4:this.selectDays(4,g);break;case 5:this.selectDays(5,g);break;case 6:this.selectDays(6,g);break}},selectDays:function(h,j){var g=this._getDate(this.oMonth);var e=(g-this.oDay);var l=new Date(this.oYear,this.oMonth,this.oDay);var k=Math.ceil((l.getTime()-this.oDate.getTime())/1000/60/60/24);for(var f=0;f<=k;f++){if(this.oDay+f<=g){b(j).eq(f+h).text(this.oDay+f).attr({"data-month":this.oMonth,"data-day":this.oDay+f})}else{b(j).eq(f+h).text(f-e).attr({"data-month":(this.oMonth+1)>12?1:(this.oMonth+1),"data-day":f-e})}b(j).eq(f+h).addClass("enable")}this.pastDays(h,b(j))},pastDays:function(g,h){var j=this._getDate(this.oMonth==1?12:(this.oMonth-1));if(g>0){if(this.oDay==1){for(var f=g;f>0;f--){h.eq(g-f).text(j-f+1).addClass("past")}}else{if(g<this.oDay){var e=[];for(var f=g;f>0;f--){h.eq(g-f).text(this.oDay-f).attr({"data-month":this.oMonth,"data-day":this.oDay-f}).addClass("past")}}else{if(g>this.oDay){var e=[];for(var f=g;f>0;f--){if(this.oDay-f>0){h.eq(g-f).text(this.oDay-f).addClass("past")}else{h.eq(g-f).text(j-(Math.abs(this.oDay-f))).addClass("past")}}}}}}},isLeapYear:function(e){if(e%4==0&&e%100!=0){return true}else{if(e%400==0){return true}else{return false}}}};b.fn.clndr=function(e){var f=new c(e)}})(Zepto);