<include file="Public:head"/>
<DIV class=clear></DIV>
<DIV class=mainBody> <include file="Public:left"/>
  <DIV id=Right>
    <DIV class="Item hr">
      <DIV class=current>{$action_name}</DIV>
    </DIV>
    <style>
.tab thead td{text-align:left}
img.operator{width:12px;height:12px;margin:0 6px;cursor:pointer; vertical-align:middle}
</style>
<js href="__PUBLIC__/js/kindeditor/kindeditor-min.js,__PUBLIC__/js/kindeditor/lang/zh_CN.js,__PUBLIC__/js/artTemplate/artTemplate.js" />
 	<script>

 	    var editor;
 	    KindEditor.ready(function(K) {
 	    editor = K.create('textarea[name="content"]', {
 	                    allowFileManager : true

 	                });

 	            });
 	</script>
    <div style="margin-bottom:10px;" class="headbar">
    <ul name="conf_menu" class="tab_goods">
		<li class="selected"><a href="javascript:select_tab('base_conf');">基本设置</a></li>
		<li class=""><a href="javascript:select_tab('guide_conf');">导航设置</a></li>
		<li class=""><a href="javascript:select_tab('index_slide');">首页幻灯设置</a></li>
		<li class=""><a href="javascript:select_tab('site_footer_conf');">站点底部信息</a></li>
		<li class=""><a href="javascript:select_tab('shopping_conf');">购物设置</a></li>
		<li class=""><a href="javascript:select_tab('show_conf');">显示设置</a></li>
		<li class=""><a href="javascript:select_tab('mail_conf');">邮箱设置</a></li>
		<li class=""><a href="javascript:select_tab('system_conf');">系统设置</a></li>
		<li class=""><a href="javascript:select_tab('service_online');">在线客服</a></li>
	</ul></div>
	<div class="content_box">
		<div class="content form_content" style="height: 0px;">
		<form novalidate="true" style="display: block;" action="__URL__/index/form/base_conf" method="post" enctype="multipart/form-data" name="base_conf">
			<!--基本设置!-->
			<table class="tab"  width="99.5%" border="0" cellspacing="0" cellpadding="0">
				<thead><tr>
					<td width='150px'>商店名称：</td>
					<td><input class="normal" name="data[name]" pattern="required" alt="商店名称必须填写" type="text" value="{:C('name')}"><label>* 网店名称</label></td>
				</tr>
				<tr>
					<td>商店网址：</td>
					<td>
						<input class="normal" name="data[url]" type="text" value="{:C('url')}">
						<label>* 网站完整的URL访问地址</label>
					</td>
				</tr>
				<tr>
					<td>商店logo：</td>
					<td>
						<div style="height:53px;overflow:hidden;">
							<img src="{:C('WEB_STATICS')}/public/{$config.logo}" onload="if(this.height>50)this.height=50" height="50">
							<input type="hidden" name='oldlogo' value='{:C('logo')}' />
						</div>
						<input class="normal" name="logo" type="file">

						<label>直接从本地上传图片覆盖原有的网站logo</label>
					</td>
				</tr>
				<tr>
					<td>联系人：</td>
					<td><input class="normal" name="data[master]" type="text" value="{:C('master')}"></td>
				</tr>
				<tr>
					<td>QQ：</td>
					<td><input class="normal" pattern="qq" name="data[qq]" empty="" alt="请填写正确的QQ号" type="text" value="{:C('qq')}"></td>
				</tr>
				<tr>
					<td>Email：</td>
					<td><input class="normal" pattern="email" name="data[email]" empty="" alt="请填写正确的email地址" type="text" value="{:C('email')}"></td>
				</tr>
				<tr>
					<td>手机：</td>
					<td><input class="normal" pattern="mobi" name="data[mobile]" empty="" alt="请填写正确的手机号码" type="text" value="{:C('mobile')}"></td>
				</tr>
				<tr>
					<td>客服电话：</td>
					<td><input class="normal" pattern="phone" name="data[phone]" empty="" alt="请填写正确的固定电话" type="text" value="{:C('phone')}"></td>
				</tr>
				<tr>
					<td>具体地址：</td>
					<td><input class="normal" pattern="required" name="data[address]" empty="" alt="商店名称必须填写" type="text" value="{:C('address')}"></td>
				</tr>
				<tr>
					<td>商品货号前缀：</td>
					<td><input class="normal" pattern="required" name="data[goodsNoPre]" empty="" alt="商品货号前缀" type="text" value="{:C('goodsNoPre')}"><label>只取前两位</label></td>
				</tr>
				<tr>
					<td>首页title后缀：</td>
					<td><input class="normal" pattern="required" name="data[indexSeoTitle]" empty="" alt="首页title后缀" type="text" value="{:C('indexSeoTitle')}"></td>
				</tr>
				<tr>
					<td>首页keywords：</td>
					<td><input class="normal" pattern="required" name="data[indexSeoKeywords]" empty="" alt="首页keywords" type="text" value="{:C('indexSeoKeywords')}"></td>
				</tr>
				<tr>
					<td>首页description：</td>
					<td><input class="normal" pattern="required" name="data[indexSeoDescription]" empty="" alt="首页description" type="text" value="{:C('indexSeoDescription')}"></td>
				</tr>
				<tr>
					<td></td>
					<td>
						<button class="btn submit" type="submit"><span>保存基本设置</span></button>
					</td>
				</tr>
			</thead></table>
		</form>

		<form novalidate="true" style="display: none;" action="__URL__/index/form/guide_conf" method="post" name="guide_conf">
			<table class="tab" width="99.5%" border="0" cellspacing="0" cellpadding="0">
				<colgroup><col width="150px">
				<col>

				</colgroup><thead><tr>
					<td>首页导航设置：</td>
					<td>

						<table class="tab" id="guide_box" border="0" cellspacing="0" cellpadding="0">
							<colgroup><col width="150px">
							<col width="250px">
							<col width="120px">
							</colgroup><thead>
							<tr>
								<td>名称</td>
								<td>链接地址</td>
								<td>操作</td>
							</tr>
							</thead>

							<tbody></tbody>

							<tfoot>
							<tr>
								<td colspan="3">
									<button type="button" class="btn" onclick="add_guide();"><span>添加导航</span></button>
								</td>
							</tr>
							</tfoot>

							<!--导航行模板-->
							<script type="text/html" id="guideTrTemplate">
							<tr class='td_c'>
								<td><input type='text' name='guide_name[]' class='small' value='<%=name%>' pattern='required' alt='请填写导航名' /></td>
								<td><input type='text' name='guide_link[]' class='middle' value='<%=link%>' pattern='required' alt='请填写URL，如：http://www.jooyea.cn' /></td>
								<td>
									<img class='operator' src='/Public/images/icon_asc.gif' alt='向上' title='向上' />
									<img class='operator' src='/Public/images/icon_desc.gif' alt='向下' title='向下' />
									<img class='operator' src='/Public/images/icon_del.gif' alt='删除' title='删除' />
								</td>
							</tr>
							</script>
						</table>
						<label>设置首页顶部导航条内容和链接地址</label>
					</td>
				</tr>
				<tr>
					<td></td>
					<td><button type="submit" class="btn submit"><span>保存导航栏配置</span></button></td>
				</tr>
			</thead></table>
		</form>

		<form novalidate="true" style="display: none;" action="__URL__/index/form/index_slide" method="post" name="index_slide" enctype="multipart/form-data">
			<table class="tab" width="99.5%" border="0" cellspacing="0" cellpadding="0">
				<colgroup><col width="150px">
				<col>

				</colgroup><thead><tr>
					<td>首页幻灯设置：</td>
					<td>

						<table class="tab" id="slide_box" border="0" cellspacing="0" cellpadding="0">
							<colgroup><col width="150px">
							<col width="250px">
							<col width="250px">
							<col width="120px">
							</colgroup><thead>
							<tr>
								<td>名称</td>
								<td>链接地址</td>
								<td>图片文件</td>
								<td>位置</td>
								<td>操作</td>
							</tr>
							</thead>

							<tbody></tbody>

							<tfoot>
								<tr>
									<td colspan="4">
										<button type="button" class="btn" onclick="add_slide();"><span>添加幻灯</span></button>
									</td>
								</tr>
							</tfoot>

							<script type="text/html" id="slideTrTemplate">
							<tr class='td_c'>
								<td><input type='text' name='slide_name[]' class='middle' value='<%=name%>' pattern='required' /></td>
								<td><input type='text' name='slide_url[]' class='middle' value='<%=url%>' pattern='required' /></td>
								<td>
									<%if(img){%>
									<img src="<%=webpath%><%=img%>" width="150px" /><br />
									<%}%>
									<input type='file' name='slide_pic[]' class='middle' />
									<input type="hidden" value="<%=img%>" name="slide_img[]" />
								</td>
								<td>
									<select name=slide_position[]>
									<option value="1">首页轮播420x661</option>
									</select>
								</td>
								<td>
									<img class='operator' src='/Public/images/icon_asc.gif' alt='向上' title='向上' />
									<img class='operator' src='/Public/images/icon_desc.gif' alt='向下' title='向下' />
									<img class='operator' src='/Public/images/icon_del.gif' alt='删除' title='删除' />
								</td>
							</tr>
							</script>
						</table>
						<label>设置首页幻灯片图片与名称</label>
					</td>
				</tr>
				<tr>
					<td></td>
					<td><button type="submit" class="btn submit"><span>保存幻灯片配置</span></button></td>
				</tr>
			</thead></table>
		</form>

		<form action="__URL__/index/form/site_footer_conf" method="post" style="display: none;" name="site_footer_conf">

			<table class="tab" width="99.5%" border="0" cellspacing="0" cellpadding="0">
				<colgroup><col width="150px">
				<col>
				</colgroup><thead><tr>
					<td>站点底部信息：</td>
					<td>
						<textarea name="content" id="content" style="width:800px;height:250px;visibility:hidden;" class="required">{:C('site_footer_code')}</textarea>
						<label>设置站点底部页面信息，您可以点源代码试图直接进行代码编辑</label>
					</td>
				</tr>
				<tr>
					<td></td>
					<td><button type="submit" class="btn submit"><span>保存站点底部信息</span></button></td>
				</tr>
			</thead></table>

		</form>

		<form novalidate="true" action="__URL__/index/form/shopping_conf" style="display: none;" method="post" name="shopping_conf">
			<!--购物设置!-->
			<table class="tab" width="99.5%" border="0" cellspacing="0" cellpadding="0">
				<colgroup><col width="150px">
				<col>
				</colgroup><thead><tr>
					<td>税率：</td>
					<td><input name="data[tax]" class="small" empty="" pattern="float" alt="请输入正确的整数或者浮点数" type="text" value="{:C('tax')}">%</td>
				</tr>
				<tr>
					<td>默认备货时间：</td>
					<td><input class="small" name="data[stockup_time]" pattern="int" alt="请填写整数" type="text"  value="{:C('stockup_time')}">天 <label>* 订单确认后需要备货的时间</label></td>
				</tr>
				<tr>
					<td>团购过期时间：</td>
					<td><input class="small" name="data[regiment_time_limit]" pattern="int" alt="请填写整数" type="text"  value="{:C('regiment_time_limit')}">分钟 <label>* 报名参加团购后多长时间不付款则视为过期，默认为60分钟</label></td>
				</tr>
				<tr>
					<td>货到付款百分比</td>
					<td><input class="small" name="data[amount_tax]" pattern="float" alt="" type="text"  value="{:C('amount_tax')}">% <label>*当卖家货到付款是，商家收取的商品价格商百分比 </label></td>
				</tr>
				<tr>
					<td></td>
					<td>
						<button class="btn submit" type="submit"><span>保存购物配置</span></button>
					</td>
				</tr>
			</thead></table>
		</form>

		<form novalidate="true" action="__URL__/index/form/show_conf" style="display: none;" method="post" name="show_conf">
			<!--显示设置!-->
			<table class="tab" width="99.5%" border="0" cellspacing="0" cellpadding="0">
				<colgroup><col width="150px">
				<col>
				</colgroup><thead><tr>
					<td>默认的排序依据：</td>
					<td>
						<select name="data[order_by]" class="normal">
							<option value="new" <if condition="C('order_by') eq 'new'"> selected="selected"</if>>上架时间</option>
							<option value="price" <if condition="C('order_by') eq 'price'"> selected="selected"</if>>价格</option>
							<option value="sale" <if condition="C('order_by') eq 'sale'"> selected="selected"</if>>销量</option>
							<option value="cpoint" <if condition="C('order_by') eq 'cpoint'"> selected="selected"</if>>评分</option>
						</select>
						<label>* 在商品列表页中商品的排序依据条件</label>
					</td>
				</tr>
				<tr>
					<td>默认的排序方式：</td>
					<td>
						<select name="data[order_type]" class="normal">
							<option value="desc" <if condition="C('order_type') eq 'desc'"> selected="selected"</if>>降序</option>
							<option value="asc" <if condition="C('order_type') eq 'asc'"> selected="selected"</if>>升序</option>
						</select>
						<label>* 在商品列表页中商品的排序方式</label>
					</td>
				</tr>
				<tr>
					<td>列表默认展示方式：</td>
					<td>
						<select name="data[list_type]" class="normal">
							<option value="list" <if condition="C('list_type') eq 'list'"> selected="selected"</if>>普通列表</option>
							<option value="win" <if condition="C('list_type') eq 'win'"> selected="selected"</if>>橱窗形式</option>
						</select>
						<label>* 在商品列表页中商品的展示样式</label>
					</td>
				</tr>
				<tr>
					<td>列表展示商品数量：</td>
					<td><input class="small" name="data[list_num]" pattern="int" type="text" value="{:C('list_num')}"><label>* 在商品列表页中商品的展示数量</label></td>
				</tr>
				<tr>
					<td>智能提示开启的字符数：</td>
					<td>
						<input class="small" name="data[auto_finish]" pattern="int" alt="请填写整数" empty="" type="text" value="{:C('auto_finish')}">
						<label>当输入若干个字符后，会出现智能提示信息</label>
					</td>
				</tr>
				<tr>
					<td></td>
					<td>
						<button class="btn submit" type="submit" onclick="add_guide();"><span>保存显示设置</span></button>
					</td>
				</tr>
			</thead></table>
		</form>

		<form novalidate="true" action="__URL__/index/form/mail_conf" style="display: none;" method="post" name="mail_conf">
			<!--邮箱设置-->
			<table class="tab" width="99.5%" border="0" cellspacing="0" cellpadding="0">
				<thead><tr>
					<td>发送Email方式：</td>
					<td>
						<label class="attr"><input name="data[email_type]" value="1"  <if condition="C('email_type') eq 1"> checked="checked"</if> onclick="show_mail(1);" type="radio">第三方SMTP方式</label>
						<label class="attr"><input name="data[email_type]" value="2" <if condition="C('email_type') eq 2"> checked="checked"</if> onclick="show_mail(2)" type="radio">本地mail邮箱</label>
						<label>* 如果本地已经搭建好邮件服务，请选择 "本地mail邮箱"，否则选择" 第三方SMTP方式 "来发送邮件</label>
					</td>
				</tr>
				<tr>
					<td>发送邮件的地址：</td>
					<td>
						<input name="data[mail_address]" pattern="email" alt="填写正确的email地址" class="normal" type="text" value="{:C('mail_address')}">
						<label>* 发送邮件所使用的email地址，邮件内容中的收件人信息就是显示此信息</label>
					</td>
				</tr>
				<tr name="smtp">
					<td>SMTP地址：</td>
					<td>
						<input name="data[smtp]" class="normal" pattern="required" empty="" alt="填写正确的email地址" type="text"  value="{:C('smtp')}">
						<label>第三方的SMTP的URL地址</label>
					</td>
				</tr>
				<tr name="smtp">
					<td>用户名：</td>
					<td>
						<input name="data[smtp_user]" class="normal" pattern="required" alt="发送邮件" empty="" type="text"  value="{:C('smtp_user')}">
						<label>SMTP用户名</label>
					</td>
				</tr>
				<tr name="smtp">
					<td>密码：</td>
					<td><input name="data[smtp_pwd]" class="normal"  empty="" type="text"  value="{:C('smtp_pwd')}"><label>SMTP密码</label></td>
				</tr>
				<tr name="smtp">
					<td>端口号：</td>
					<td><input name="data[smtp_port]" class="small" empty="" type="text" value="{:C('smtp_port')}"><label>SMTP端口号(默认：25)</label></td>
				</tr>
				<tr>
					<td>测试邮件地址：</td>
					<td><input name="data[test_address]" pattern="email" class="normal" empty="" alt="填写正确的email地址" type="text" value="{:C('test_address')}"><label>用于测试邮件发送的功能【可选】</label></td>
				</tr>
				<tr>
					<td></td>
					<td>
						<button class="btn submit" type="submit"><span>保存邮箱设置</span></button>
						<button class="btn" type="button" onclick="test_mail(this);"><span id="testmail">测试邮件发送</span></button>
					</td>
				</tr>
			</thead></table>
		</form>

		<form novalidate="true" action="__URL__/index/form/system_conf" style="display: none;" method="post" name="system_conf">
			<table class="tab" width="99.5%" border="0" cellspacing="0" cellpadding="0">
				<colgroup><col width="150px">
				<col>
				</colgroup><thead><tr>
					<td>清理模板缓存：</td>
					<td>
						<button class="btn" type="button" onclick="clearCache();"><span>开始清理</span></button>
						<label>清理系统编译生成的模板缓存文件</label>
					</td>
				</tr>

				<tr>
					<td>私密信息存储策略：</td>
					<td>
						<select name="data[safe]" class="normal" pattern="required" alt="请选择一种语言">
							<option value="cookie" <if condition="C('safe') eq 'cookie'"> selected="selected"</if>>COOKIE方案(存放于客户端)</option>
							<option value="session" <if condition="C('safe') eq 'session'"> selected="selected"</if>>SESSION方案(存放于服务器端)</option>
						</select>
						<label>注意：修改此设置后，用户会被强制退出。默认：COOKIE方案</label>
					</td>
				</tr>

				<tr>
					<td>私密信息防窃取级别：</td>
					<td>
						<select name="data[safeLevel]" class="normal" pattern="required" alt="请选择一种级别">
							<option value="none" <if condition="C('safeLevel') eq 'none'"> selected="selected"</if>>低(不进行校验)</option>
							<option value="normal" <if condition="C('safeLevel') eq 'normal'"> selected="selected"</if>>中(校验IP地址的一致性)</option>
							<option value="advance" <if condition="C('safeLevel') eq 'advance'"> selected="selected"</if>>高(校验IP地址和用户浏览器一致性)</option>
						</select>
						<label>可以有效的防止cookie和session的窃取。注意：当修改了此设置，用户会被强制退出，浏览器需要清空缓存。默认：中</label>
					</td>
				</tr>

				<tr>
					<td>设置语言包：</td>
					<td>
												<select class="normal" name="data[lang]" pattern="required" alt="请选择一种语言">
														<option value="zh_sc" <if condition="C('lang') eq 'zh_sc'"> selected="selected"</if>>中文(简体)</option>
													</select>
						<label>切换整站语言</label>
					</td>
				</tr>

				<tr>
					<td>伪静态：</td>
					<td>
						<label class="attr"><input name="data[rewriteRule]" value="pathinfo"  <if condition="C('rewriteRule') eq 'pathinfo'"> checked="checked"</if> type="radio">开启</label>
						<label class="attr"><input name="data[rewriteRule]" value="url" type="radio" <if condition="C('rewriteRule') eq 'url'"> checked="checked"</if>>关闭</label>
						<label>开启伪静态前请先确保你的服务器环境支持伪静态规则，如果开启后出现问题，则需手动修改config/config.php中的url参数，设定为：url</label>
					</td>
				</tr>
				<tr>
					<td></td>
					<td><button class="btn submit" type="submit"><span>保存系统设置</span></button></td>
				</tr>
			</thead></table>
		</form>

		<form novalidate="true" action="__URL__/index/form/service_online" style="display: none;" method="post" name="service_online">
			<table class="tab" width="99.5%" border="0" cellspacing="0" cellpadding="0">
				<thead><tr>
					<td>在线客服设置：</td>
					<td>

						<table class="tab" id="service_box" border="0" cellspacing="0" cellpadding="0">
							<colgroup><col width="250px">
							<col width="250px">
							<col width="120px">
							</colgroup><thead>
							<tr>
								<td>客服名称</td>
								<td>QQ号码</td>
								<td>操作</td>
							</tr>
							</thead>

							<tbody></tbody>

							<tfoot>
								<tr>
									<td colspan="3">
										<button type="button" class="btn" onclick="add_service();"><span>添加客服</span></button>
									</td>
								</tr>
							</tfoot>

							<script type="text/html" id="serviceTrTemplate">
							<tr class='td_c'>
								<td><input type='text' name='service_name[]' class='middle' value='<%=name%>' pattern='required' /></td>
								<td><input type='text' name='service_qq[]' class='middle' value='<%=qq%>' pattern='required' /></td>
								<td>
									<img class='operator' src='/Public/images/icon_asc.gif' alt='向上' title='向上' />
									<img class='operator' src='/Public/images/icon_desc.gif' alt='向下' title='向下' />
									<img class='operator' src='/Public/images/icon_del.gif' alt='删除' title='删除' />
								</td>
							</tr>
							</script>
						</table>

						<label>设置在线客服</label>
					</td>
				</tr>
				<tr>
					<td></td>
					<td><button type="submit" class="btn submit"><span>保存在线客服</span></button></td>
				</tr>
			</thead></table>
		</form>
	</div>
	</div>
  </DIV>
</DIV>
</DIV>
<DIV class=clear></DIV>
<include file="Public:foot"/>
</BODY></HTML>
<script>

/* $('.submit').click(function(){
	var i = $('.submit').index(this);
	var formObject = document.forms[i];
	var url = $(formObject).attr('action');
	editor.sync();
	$.post(url, $(formObject).serialize(), function(json){

		if(json.status == 1)
		{
			popup.alert(json.info);
			location.href =json.url;
			return false;
		}
		else
		{
			popup.alert(json.info);
			return false;
		}
	},'json');
	return false;
}); */
//DOM加载完毕
var imgparent = '{:C('WEB_STATICS')}';
$(function(){


	//邮箱却换
	<if condition="$config['email_type'] eq 1">
	show_mail(1);
	<else />
	show_mail(2);
	</if>
	//生成导航
	<if condition="$guide">
	var guideList = <?php echo json_encode($guide);?>;
	for(var index in guideList)
	{
		add_guide(guideList[index]);
	}
	<else />
		add_guide();
	</if>

	//生成幻灯片


	<if condition="isset($config['index_slide']) AND $config['index_slide'] AND $slide = unserialize($config['index_slide'])">
	var slideList = <?php echo json_encode($slide);?>;
	for(var index in slideList)
	{
		add_slide(slideList[index]);
	}
	<else />
		add_slide();
	</if>

	//生成在线客服
	<if condition="isset($config['service_online']) AND $config['service_online'] AND $serviceOnline = unserialize($config['service_online'])">
	var serviceOnlineList = <?php echo json_encode($serviceOnline);?>;
	for(var index in serviceOnlineList)
	{
		add_service(serviceOnlineList[index]);
	}
	<else />
		add_service();
	</if>

	//全部表单自动填入值

});

//添加导航
function add_guide(data)
{
	var data = data ? data : {};
	data['webpath'] = imgparent;
	var guideTrHtml = template.render('guideTrTemplate',data);
	$('#guide_box tbody').append(guideTrHtml);
	var last_index = $('#guide_box tbody tr').size()-1;
	buttonInit(last_index);
}

//增加幻灯片
function add_slide(data)
{
	var data = data ? data : {};
	data['webpath'] = imgparent;
	var slideTrHtml = template.render('slideTrTemplate',data);
	$('#slide_box tbody').append(slideTrHtml);
	var last_index = $('#slide_box tbody tr').size()-1;
	buttonInit(last_index,'#slide_box');
}

//添加客服
function add_service(data)
{
	var data = data ? data : {};
	data['webpath'] = imgparent;
	var serviceTrHtml = template.render('serviceTrTemplate',data);
	$('#service_box tbody').append(serviceTrHtml);
	var last_index = $('#service_box tbody tr').size()-1;
	buttonInit(last_index,'#service_box');
}


//操作按钮绑定
function buttonInit(indexValue,ele)
{
	ele = ele || "#guide_box";
	if(indexValue == undefined || indexValue === '')
	{
		var button_times = $(ele+' tbody tr').length;

		for(var item=0;item < button_times;item++)
		{
			buttonInit(item,ele);
		}
	}
	else
	{
		var obj = $(ele+' tbody tr:eq('+indexValue+') .operator')

		//功能操作按钮
		obj.each(
			function(i)
			{
				switch(i)
				{
					//向上排序
					case 0:
					{
						$(this).click(
							function()
							{
								var insertIndex = $(this).parent().parent().prev().index();
								if(insertIndex >= 0)
								{
									$(ele+' tbody tr:eq('+insertIndex+')').before($(this).parent().parent());
								}
							}
						)
					}
					break;

					//向上排序
					case 1:
					{
						$(this).click(
							function()
							{
								var insertIndex = $(this).parent().parent().next().index();
								$(ele+' tbody tr:eq('+insertIndex+')').after($(this).parent().parent());
							}
						)
					}
					break;

					//删除排序
					case 2:
					{
						$(this).click(
							function()
							{
								var obj = $(this);
								art.dialog.confirm('确定要删除么？',function(){obj.parent().parent().remove()});
							}
						)
					}
					break;
				}
			}
		)
	}
}

//切换邮箱设置
function show_mail(checkedVal)
{
	if(checkedVal==1)
		$('table tr[name="smtp"] *').show();
	else
		$('table tr[name="smtp"] *').hide();
}
//滑动门
	function select_tab(indexVal)
	{
		//设置默认值
		if(indexVal == '')
		{
			indexVal = 'base_conf';
		}

		var formObj  = $('form[name="'+indexVal+'"]');
		var li_index = $('form').index(formObj);

		//切换form
		$('form').hide();
		$('form:eq('+li_index+')').show();

		//切换li
		$('ul[name="conf_menu"] li').attr('class','');
		$('ul[name="conf_menu"] li:eq('+li_index+')').attr('class','selected');
	}
	//测试邮件发送
	function test_mail(obj)
	{
		$('form[name="mail_conf"] input:text').each(function(){
			$(this).trigger('change');
		});

		if($('form[name="mail_conf"] input:text.invalid-text').length > 0)
		{
			return;
		}

		//按钮控制
		obj.disabled = true;
		$('#testmail').html('正在测试发送请稍后...');

		var ajaxUrl = '__URL__/testSendMail/@random@}';
		ajaxUrl     = ajaxUrl.replace('@random@',Math.random());

		$.getJSON(ajaxUrl,$('form[name="mail_conf"]').serialize(),function(content){
			obj.disabled = false;
			$('#testmail').html('测试邮件发送');
			popup.alert(content.message);
		});
	}
	//清理缓存
	function clearCache()
	{
		loadding('请稍候，系统正在清理缓存文件...');
		jQuery.get('__URL__/clearCache',function(content)
		{
			unloadding();
			var content = $.trim(content);
			if(content == 1)
				art.dialog.tips('清理成功！', 1.5);
			else
				art.dialog.tips('清理失败！', 1.5);
		});
	}


	</script>
